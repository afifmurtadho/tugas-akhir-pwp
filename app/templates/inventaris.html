{% extends "layout.html" %}
{% block content %}

<!-- Form Tambah/Edit Inventaris -->
<div class="card shadow-sm border-0 mb-4 collapse {{ 'show' if inventaris_to_edit else '' }}" id="formInventaris">
    <div class="card-body p-4">
        
        <h3 class="fw-bold mb-4">{{ 'Edit Inventaris' if inventaris_to_edit else 'Tambah Inventaris' }}</h3>

        <form method="POST" action="{{ url_for('web.inventaris') }}">
            <input type="hidden" name="form_mode" value="{{ 'update' if inventaris_to_edit else 'add' }}">
            
            {% if inventaris_to_edit %}
            <input type="hidden" name="id_inventaris" value="{{ inventaris_to_edit.id_inventaris }}">
            {% endif %}
            
            <div class="row g-3">
                <div class="col-md-4">
                    <label class="form-label">Nama Barang</label>
                    <input type="text" name="nama_barang" class="form-control" required
                           value="{{ inventaris_to_edit.nama_barang if inventaris_to_edit else '' }}"
                           placeholder="Contoh: Pakan Singa, Alat Pembersih">
                </div>
                
                <div class="col-md-3">
                    <label class="form-label">Kategori</label>
                    <input type="text" name="kategori" class="form-control"
                           value="{{ inventaris_to_edit.kategori if inventaris_to_edit else '' }}"
                           placeholder="Contoh: Pakan, Peralatan">
                </div>
                
                <div class="col-md-2">
                    <label class="form-label">Jumlah</label>
                    <input type="number" name="jumlah" class="form-control" required
                           value="{{ inventaris_to_edit.jumlah if inventaris_to_edit else '' }}"
                           placeholder="0">
                </div>
                
                <div class="col-md-3">
                    <label class="form-label">Satuan</label>
                    <input type="text" name="satuan" class="form-control"
                           value="{{ inventaris_to_edit.satuan if inventaris_to_edit else '' }}"
                           placeholder="Kg, Pcs, Unit">
                </div>
                
                <div class="col-md-4">
                    <label class="form-label">Kondisi</label>
                    <select name="kondisi" class="form-select" required>
                        <option value="Baik" {% if inventaris_to_edit and inventaris_to_edit.kondisi == 'Baik' %}selected{% endif %}>Baik</option>
                        <option value="Rusak Ringan" {% if inventaris_to_edit and inventaris_to_edit.kondisi == 'Rusak Ringan' %}selected{% endif %}>Rusak Ringan</option>
                        <option value="Rusak Berat" {% if inventaris_to_edit and inventaris_to_edit.kondisi == 'Rusak Berat' %}selected{% endif %}>Rusak Berat</option>
                        <option value="Perlu Penggantian" {% if inventaris_to_edit and inventaris_to_edit.kondisi == 'Perlu Penggantian' %}selected{% endif %}>Perlu Penggantian</option>
                    </select>
                </div>
                
                <div class="col-md-4">
                    <label class="form-label">Tanggal Update</label>
                    <input type="date" name="tanggal_update" class="form-control"
                           value="{{ inventaris_to_edit.tanggal_update if inventaris_to_edit else '' }}">
                </div>
                
                <div class="col-12">
                    {% if inventaris_to_edit %}
                        <button type="submit" class="btn btn-success">Update</button>
                        <a href="{{ url_for('web.inventaris') }}" class="btn btn-secondary">Batal</a>
                    {% else %}
                        <button type="submit" class="btn btn-primary">Simpan</button>
                    {% endif %}
                </div>
            </div>
        </form>
    </div>
</div>

<!-- Header & Button Tambah -->
<div class="d-flex justify-content-between align-items-center mb-4">
    <h3 class="fw-bold mb-0">Daftar Inventaris</h3>
    
    {% if not inventaris_to_edit %}
    <button class="btn btn-primary" type="button" data-bs-toggle="collapse" data-bs-target="#formInventaris">
        Tambah Inventaris
    </button>
    {% endif %}
</div>

<!-- Tabel Daftar Inventaris -->
<div class="card shadow-sm border-0">
    <div class="card-body">
        <div class="table-responsive">
            <table class="table table-striped table-bordered table-hover align-middle">
                <thead class="table-dark">
                    <tr class="text-center">
                        <th>No</th>
                        <th>Nama Barang</th>
                        <th>Kategori</th>
                        <th>Jumlah</th>
                        <th>Satuan</th>
                        <th>Kondisi</th>
                        <th>Tanggal Update</th>
                        <th>Aksi</th>
                    </tr>
                </thead>
                <tbody>
                    {% for i in inventaris %}
                    <tr>
                        <td class="text-center">{{ loop.index }}</td>
                        <td>{{ i.nama_barang }}</td>
                        <td>{{ i.kategori or '-' }}</td>
                        <td class="text-center">{{ i.jumlah }}</td>
                        <td class="text-center">{{ i.satuan or '-' }}</td>
                        <td class="text-center">
                            <span class="badge 
                                {% if i.kondisi == 'Baik' %}bg-success
                                {% elif i.kondisi == 'Rusak Ringan' %}bg-warning
                                {% elif i.kondisi == 'Rusak Berat' %}bg-danger
                                {% else %}bg-dark{% endif %}">
                                {{ i.kondisi }}
                            </span>
                        </td>
                        <td class="text-center">{{ i.tanggal_update or '-' }}</td>
                        <td class="text-center">
                            <a href="{{ url_for('web.inventaris', edit=i.id_inventaris) }}" class="btn btn-warning btn-sm">
                                Edit
                            </a>
                            <a href="{{ url_for('web.delete_inventaris', id_inventaris=i.id_inventaris) }}" 
                               onclick="return confirm('Hapus data inventaris ini?')" 
                               class="btn btn-danger btn-sm">
                                Hapus
                            </a>
                        </td>
                    </tr>
                    {% else %}
                    <tr>
                        <td colspan="8" class="text-center text-muted">Belum ada data inventaris</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>

{% endblock %}
